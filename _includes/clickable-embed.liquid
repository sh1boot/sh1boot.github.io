{%- capture aspect %}{% if include.aspect -%}
  {{include.aspect}}
{%- else -%}
  16/9
{%- endif %}{% endcapture %}
{%- capture frameid %}{% if include.id -%}
  {{include.id}}
{%- else -%}
  clickable-embed-{%- increment clickable_embed_calls %}
{%- endif %}{%- endcapture %}

{%- if page.id != clickable_embed_pageid -%}
{%- capture clickable_embed_pageid %}{{page.id}}{% endcapture %}
<style>
  .click-embed {
    background-color: transparent;
    border-style: none;
    width: 100%;
  }
</style>
{%- endif %}

{%- capture inner -%}
  <style> html,body {
    overflow: clip;
    margin: 0;
    background-color: transparent;
    justify-content: center center;
    text-align: center;
    height: 100%;
  }
  .maximised-image {
    object-fit: contain;
    width: 100%;
    height: 100%;
  }
  .button {
    position: absolute;
    top: 5%;
    left: 5%;
    padding: 6px 6px;
    border: 1px outset buttonborder;
    color: buttontext;
    background-color: buttonface;
    font-family: sans-serif;
    text-decoration: none;
  } </style>
  <img class="maximised-image" src="{{include.preview}}" />
  <a href="{{include.embed}}">
    {%- if include.buttontext -%}
      <div class="button">{{include.buttontext}}</div>
    {%- endif -%}
    {%- if include.buttonhtml -%}
      {{include.buttonhtml}}
    {%- endif -%}
  </a>
{%- endcapture %}

<iframe class="click-embed" id="{{frameid}}" name="{{frameid}}"
    style="aspect-ratio:{{aspect}};"
    scrolling="no" allowfullscreen
    sandbox="{{sandbox}}" srcdoc="{{inner | escape}}">
  <a href="{{include.direct}}">
    <img src="{{include.preview}}" />
  </a>
</iframe>
